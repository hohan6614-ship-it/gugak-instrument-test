<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>êµ­ì•…ê¸° ì„±ê²© í…ŒìŠ¤íŠ¸ (9ë¬¸í•­)</title>
  <meta name="description" content="9ë¬¸í•­ìœ¼ë¡œ ì•Œì•„ë³´ëŠ” ë‚˜ì˜ êµ­ì•…ê¸° ìœ í˜•: ê°€ì•¼ê¸ˆ/ê±°ë¬¸ê³ /ëŒ€ê¸ˆ/ì†Œê¸ˆ/í”¼ë¦¬(íƒœí‰ì†Œ)/í•´ê¸ˆ/ì•„ìŸ/ì¥êµ¬" />
  <style>
    :root{
      --bg:#0b0c10;
      --card:#121420;
      --text:#e9ecff;
      --muted:#a9b0d6;
      --line:rgba(255,255,255,.10);
      --accent:#7c5cff;
      --accent2:#28d7a4;
      --danger:#ff4d6d;
      --shadow: 0 18px 60px rgba(0,0,0,.45);
      --r:18px;
      --max: 980px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      background:
        radial-gradient(1200px 600px at 20% 10%, rgba(124,92,255,.18), transparent 60%),
        radial-gradient(900px 500px at 90% 20%, rgba(40,215,164,.14), transparent 55%),
        radial-gradient(900px 700px at 40% 100%, rgba(255,77,109,.10), transparent 55%),
        var(--bg);
      color:var(--text);
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, "Apple SD Gothic Neo", "Noto Sans KR", Arial, "ë§‘ì€ ê³ ë”•", sans-serif;
      line-height:1.35;
    }

    .wrap{max-width:var(--max); margin:0 auto; padding:24px 16px 56px; position:relative;}
    .hero{
      display:flex; gap:16px; align-items:flex-start; justify-content:space-between;
      margin-bottom:14px;
    }
    .brand{
      display:flex; gap:14px; align-items:center;
    }
    .logo{
      width:64px; height:64px; border-radius:16px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.04);
      object-fit:cover;
      box-shadow: 0 10px 35px rgba(0,0,0,.35);
      flex:0 0 auto;
    }
    .title{
      display:flex; flex-direction:column; gap:6px;
    }
    h1{margin:0; font-size: clamp(20px, 2.6vw, 34px); letter-spacing:-.02em;}
    .sub{color:var(--muted); font-size:14px; max-width: 62ch;}
    .pill{
      display:inline-flex; align-items:center; gap:8px;
      background: rgba(255,255,255,.06);
      border:1px solid var(--line);
      padding:8px 12px;
      border-radius:999px;
      color:var(--muted);
      font-size:12px;
      white-space:nowrap;
      height: fit-content;
    }
    .pill b{color:var(--text)}

    /* mascot */
    .mascotFloat{
      position:absolute;
      right: 10px;
      top: 6px;
      width: 110px;
      height:auto;
      opacity: .95;
      transform: rotate(2deg);
      filter: drop-shadow(0 18px 45px rgba(0,0,0,.55));
      pointer-events:none;
      user-select:none;
    }
    @media (max-width: 720px){
      .hero{flex-direction:column; align-items:flex-start}
      .mascotFloat{right: 2px; top: 84px; width: 92px; opacity:.9;}
    }

    .card{
      background: linear-gradient(180deg, rgba(255,255,255,.06), rgba(255,255,255,.03));
      border: 1px solid var(--line);
      border-radius: var(--r);
      box-shadow: var(--shadow);
      overflow:hidden;
    }
    .card .top{
      padding:16px 16px 12px;
      border-bottom:1px solid var(--line);
      display:flex; gap:10px; align-items:center; justify-content:space-between;
      background: rgba(0,0,0,.15);
    }
    .progress{
      flex:1;
      height:10px;
      background: rgba(255,255,255,.07);
      border:1px solid var(--line);
      border-radius:999px;
      overflow:hidden;
    }
    .bar{
      height:100%;
      width:0%;
      background: linear-gradient(90deg, var(--accent), var(--accent2));
      border-radius:999px;
      transition: width .25s ease;
    }
    .pct{color:var(--muted); font-size:12px; min-width:70px; text-align:right;}
    .body{padding:16px;}

    .q{
      border:1px solid var(--line);
      border-radius:16px;
      background: rgba(0,0,0,.12);
      padding:14px;
      margin-bottom:12px;
    }
    .q h3{
      margin:0 0 10px;
      font-size:15px;
      letter-spacing:-.01em;
      display:flex; align-items:center; gap:10px;
    }
    .q .num{
      width:28px; height:28px; border-radius:10px;
      display:inline-grid; place-items:center;
      background: rgba(124,92,255,.18);
      border:1px solid rgba(124,92,255,.35);
      color:var(--text);
      font-weight:800;
      font-size:13px;
      flex:0 0 auto;
    }
    .q .multi{
      margin-left:auto;
      color: rgba(233,236,255,.75);
      font-size:12px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.04);
      padding:6px 10px;
      border-radius:999px;
    }

    .opts{
      display:grid;
      grid-template-columns: repeat(2, minmax(0,1fr));
      gap:10px;
    }
    @media (max-width: 720px){
      .opts{grid-template-columns:1fr;}
    }

    label.opt{
      display:flex; gap:10px; align-items:flex-start;
      padding:12px 12px;
      border-radius:14px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.03);
      cursor:pointer;
      transition: transform .05s ease, border-color .2s ease, background .2s ease;
      user-select:none;
    }
    label.opt:hover{border-color: rgba(255,255,255,.22); transform: translateY(-1px);}
    label.opt input{margin-top:2px;}
    .opt .tag{
      display:inline-flex; align-items:center; justify-content:center;
      width:26px; height:26px;
      border-radius:10px;
      background: rgba(40,215,164,.14);
      border:1px solid rgba(40,215,164,.28);
      font-weight:900;
      font-size:12px;
      flex:0 0 auto;
    }
    .opt .txt{color:var(--text); font-size:14px;}

    .actions{
      display:flex; gap:10px; flex-wrap:wrap;
      margin-top:14px;
      justify-content:space-between;
      align-items:center;
    }
    .btns{display:flex; gap:10px; flex-wrap:wrap;}
    button{
      border:1px solid var(--line);
      background: rgba(255,255,255,.06);
      color: var(--text);
      padding:11px 14px;
      border-radius:14px;
      font-weight:800;
      cursor:pointer;
      transition: transform .05s ease, background .2s ease, border-color .2s ease;
    }
    button:hover{border-color: rgba(255,255,255,.22); transform: translateY(-1px);}
    button.primary{
      background: linear-gradient(90deg, rgba(124,92,255,.95), rgba(40,215,164,.92));
      border-color: transparent;
      color:#0b0c10;
    }
    button.danger{
      background: rgba(255,77,109,.12);
      border-color: rgba(255,77,109,.28);
    }
    .hint{color:var(--muted); font-size:12px;}
    .err{
      display:none;
      margin-top:10px;
      padding:10px 12px;
      border-radius:14px;
      border:1px solid rgba(255,77,109,.35);
      background: rgba(255,77,109,.10);
      color:#ffd0d8;
      font-size:13px;
    }

    .result{
      display:none;
      margin-top:14px;
      border-top:1px solid var(--line);
      padding-top:14px;
    }
    .rgrid{
      display:grid;
      grid-template-columns: 1.1fr .9fr;
      gap:12px;
      align-items:start;
    }
    @media (max-width: 900px){
      .rgrid{grid-template-columns:1fr;}
    }
    .rtype{font-size:20px; margin:0; letter-spacing:-.02em;}
    .badge{
      display:inline-flex; gap:8px; align-items:center;
      padding:8px 10px;
      border-radius:999px;
      background: rgba(255,255,255,.06);
      border:1px solid var(--line);
      color:var(--muted);
      font-size:12px;
      white-space:nowrap;
      margin-top:8px;
    }
    .desc{color:var(--text); font-size:14px; margin:8px 0 12px;}
    .chips{display:flex; gap:8px; flex-wrap:wrap; margin:8px 0 0;}
    .chip{
      border:1px solid var(--line);
      background: rgba(0,0,0,.18);
      color:var(--muted);
      padding:7px 10px;
      border-radius:999px;
      font-size:12px;
    }

    .mascotCard{
      border:1px solid var(--line);
      background: rgba(0,0,0,.14);
      border-radius:16px;
      padding:12px;
      display:flex;
      gap:12px;
      align-items:center;
    }
    .mascotImg{
      width:96px; height:96px;
      border-radius:18px;
      border:1px solid var(--line);
      background: rgba(255,255,255,.04);
      object-fit:cover;
      flex:0 0 auto;
    }
    .mascotMeta{
      color:var(--muted);
      font-size:12px;
      line-height:1.4;
    }
    .mascotMeta b{color:var(--text);}

    .sharebox{
      border:1px solid var(--line);
      background: rgba(0,0,0,.14);
      border-radius:16px;
      padding:12px;
      margin-top:12px;
    }
    .shareline{
      display:flex; gap:10px; flex-wrap:wrap; align-items:center; justify-content:space-between;
    }
    .sharetext{
      color:var(--muted);
      font-size:12px;
      word-break:break-all;
    }
    footer{
      margin-top:14px;
      color:rgba(233,236,255,.55);
      font-size:12px;
      text-align:center;
    }
  </style>
</head>
<body>
  <div class="wrap">
    <img id="mascotFloat" class="mascotFloat" alt="ë§ˆìŠ¤ì½”íŠ¸" src="assets/mascot1.png" />

    <div class="hero">
      <div class="brand">
        <img class="logo" src="assets/logo.png" alt="ë™ì•„ë¦¬ ë¡œê³ " />
        <div class="title">
          <h1>ğŸ¶ êµ­ì•…ê¸° ì„±ê²© í…ŒìŠ¤íŠ¸</h1>
          <div class="sub">ë³µìˆ˜ì„ íƒ ê°€ëŠ¥! (ê° ë¬¸í•­ì—ì„œ ì—¬ëŸ¬ ê°œ ì²´í¬ ê°€ëŠ¥) Â· ìœ í˜• ì•ŒíŒŒë²³(A~H)ì€ ë§¤ë²ˆ ëœë¤ìœ¼ë¡œ ì„ì—¬ìš”</div>
        </div>
      </div>
      <div class="pill">ì§„í–‰: <b id="doneCount">0</b>/9</div>
    </div>

    <section class="card">
      <div class="top">
        <div class="progress" aria-label="progress">
          <div class="bar" id="bar"></div>
        </div>
        <div class="pct" id="pct">0%</div>
      </div>

      <div class="body" id="test">
        <!-- Questions injected by JS -->
        <div class="actions">
          <div class="btns">
            <button class="primary" id="calcBtn" type="button">ê²°ê³¼ ë³´ê¸°</button>
            <button class="danger" id="resetBtn" type="button">ì²˜ìŒë¶€í„°</button>
          </div>
          <div class="hint">ê° ë¬¸í•­ì€ <b>ë³µìˆ˜ì„ íƒ(ì²´í¬ë°•ìŠ¤)</b> ê°€ëŠ¥. ìµœì†Œ 1ê°œëŠ” ì„ íƒí•´ì¤˜!</div>
        </div>

        <div class="err" id="err"></div>

        <div class="result" id="result">
          <div class="rgrid">
            <div>
              <h2 class="rtype" id="rtype">ê²°ê³¼</h2>
              <div class="desc" id="rdesc"></div>
              <div class="chips" id="rchips"></div>
              <div class="badge" id="rbadge">ìœ í˜• ì½”ë“œ: -</div>

              <div class="sharebox">
                <div class="shareline">
                  <div class="sharetext" id="shareText">ê³µìœ  ë¬¸êµ¬ê°€ ì—¬ê¸°ì— í‘œì‹œë©ë‹ˆë‹¤.</div>
                  <div class="btns">
                    <button id="copyBtn" type="button">ê³µìœ  ë¬¸êµ¬ ë³µì‚¬</button>
                    <button id="copyLinkBtn" type="button">ë§í¬ ë³µì‚¬</button>
                  </div>
                </div>
              </div>
            </div>

            <div class="mascotCard">
              <img id="mascotResult" class="mascotImg" src="assets/mascot1.png" alt="ë§ˆìŠ¤ì½”íŠ¸" />
              <div class="mascotMeta">
                <div><b>ë§ˆìŠ¤ì½”íŠ¸</b>ê°€ ê²°ê³¼ë¥¼ ì¶•í•˜í•´ìš” ğŸ‰</div>
                <div style="margin-top:6px;">(í˜ì´ì§€ ìƒˆë¡œê³ ì¹¨ë§ˆë‹¤ ë‹¤ë¥¸ í¬ì¦ˆê°€ ë‚˜ì™€ìš”)</div>
              </div>
            </div>
          </div>

          <footer>Â© êµ­ì•…ê¸° í…ŒìŠ¤íŠ¸ Â· assets í´ë”ì— ë¡œê³ /ë§ˆìŠ¤ì½”íŠ¸ ì´ë¯¸ì§€ ë„£ìœ¼ë©´ ìë™ ë°˜ì˜</footer>
        </div>
      </div>
    </section>
  </div>

<script>
  // ====== Utilities ======
  function shuffle(arr){
    const a = arr.slice();
    for(let i=a.length-1;i>0;i--){
      const j = Math.floor(Math.random()*(i+1));
      [a[i], a[j]] = [a[j], a[i]];
    }
    return a;
  }

  // ====== Mascots ======
  const mascots = [
    "assets/mascot1.png",
    "assets/mascot2.png",
    "assets/mascot3.png",
    "assets/mascot4.png",
    "assets/mascot5.png",
    "assets/mascot6.png",
    "assets/mascot7.png",
  ];
  function pickMascot(){
    return mascots[Math.floor(Math.random()*mascots.length)];
  }
  const pickedMascot = pickMascot();
  document.getElementById("mascotFloat").src = pickedMascot;
  document.getElementById("mascotResult").src = pickedMascot;

  // ====== Types ======
  const mapType = {
    A: { name:"ê°€ì•¼ê¸ˆí˜•", code:"A", short:"ê°ì„± ê³µê°ëŸ¬",
      desc:"ì„¬ì„¸í•˜ê³  ë”°ëœ»í•œ ê³µê°ìœ¼ë¡œ ë¶„ìœ„ê¸°ë¥¼ ë¶€ë“œëŸ½ê²Œ ë§Œë“œëŠ” íƒ€ì…. ê°ì •ì˜ ê²°ì„ ì˜ ëŠë¼ê³ , ê´€ê³„ë¥¼ ì˜¤ë˜ ê°€ê¾¸ëŠ” í¸ì´ì—ìš”.",
      chips:["ë”°ëœ»í•¨","ê³µê°","ë¶„ìœ„ê¸° ì•ˆì •","ì„¬ì„¸í•œ í‘œí˜„"]
    },
    B: { name:"ê±°ë¬¸ê³ í˜•", code:"B", short:"ë¬µì§í•œ ì „ëµê°€",
      desc:"ë§ìˆ˜ëŠ” ì ì–´ë„ ì¤‘ì‹¬ì„ ì¡ê³  ê¹Šê²Œ ìƒê°í•˜ëŠ” íƒ€ì…. ì¡°ìš©í•˜ì§€ë§Œ ì¡´ì¬ê°ì´ í¬ê³ , ì‹ ë¢°ë¥¼ ì²œì²œíˆ ìŒ“ì•„ìš”.",
      chips:["ì‹ ì¤‘í•¨","ê¹Šì´","ìê¸° ê¸°ì¤€","ë¬´ê²Œê°"]
    },
    C: { name:"ëŒ€ê¸ˆí˜•", code:"C", short:"ê°ì„± ì˜ˆìˆ ê°€",
      desc:"ê°ì •ê³¼ ì˜ê°ì´ íë¥´ëŠ” ëŒ€ë¡œ í‘œí˜„í•˜ëŠ” íƒ€ì…. ììœ ë¡­ê³  ì¦‰í¥ì ì´ë©°, ë¶„ìœ„ê¸°ë¥¼ â€˜í™•â€™ ë°”ê¾¸ëŠ” ì¬ëŠ¥ì´ ìˆì–´ìš”.",
      chips:["í‘œí˜„ë ¥","ì¦‰í¥ì„±","ììœ ë¡œì›€","ì˜ê°"]
    },
    D: { name:"ì†Œê¸ˆí˜•", code:"D", short:"ë§‘ì€ ê´€ì°°ì",
      desc:"ì¡°ìš©í•˜ì§€ë§Œ ì˜ˆë¯¼í•œ ê°ê°ìœ¼ë¡œ ìƒí™©ì„ ì½ëŠ” íƒ€ì…. ì‘ì€ ë””í…Œì¼ì„ ì˜ ë³´ê³ , ë§‘ê³  ì •êµí•œ ì·¨í–¥ì„ ê°€ì¡Œì–´ìš”.",
      chips:["ê´€ì°°ë ¥","ì„¬ì„¸í•¨","ì •ì œëœ ì·¨í–¥","ì¡°ìš©í•œ ì¡´ì¬ê°"]
    },
    E: { name:"í”¼ë¦¬/íƒœí‰ì†Œí˜•", code:"E", short:"ê°•ë ¬í•œ ë¦¬ë”",
      desc:"ì¶”ì§„ë ¥ê³¼ ì—ë„ˆì§€ê°€ ê°•í•œ íƒ€ì…. â€˜ë‚´ê°€ ë‚˜ì„œì•¼ í•œë‹¤â€™ëŠ” ìˆœê°„ì„ ì˜ ì•Œê³ , ì¡´ì¬ê°ìœ¼ë¡œ íŒì„ ì—´ì–´ìš”.",
      chips:["ì¶”ì§„ë ¥","ì¹´ë¦¬ìŠ¤ë§ˆ","ì§ì§„","ì—ë„ˆì§€"]
    },
    F: { name:"í•´ê¸ˆí˜•", code:"F", short:"ì„œì‚¬ ê³µê° ì¥ì¸",
      desc:"ì‚¬ëŒì˜ ê°ì •ì„ ì„ ê¹Šê²Œ ì½ëŠ” íƒ€ì…. ìŠ¬í””ë„ ì•„ë¦„ë‹µê²Œ ë‹¤ë£¨ê³ , ëˆ„êµ°ê°€ì˜ ë§ˆìŒì„ ì •í™•íˆ ì–´ë£¨ë§Œì ¸ìš”.",
      chips:["ê³µê°ë ¥","ê°ì •ì„ ","ì§„ì •ì„±","ì¹˜ìœ "]
    },
    G: { name:"ì•„ìŸí˜•", code:"G", short:"ë¬µì§í•œ í˜„ì‹¤ì£¼ì˜ì",
      desc:"ì‰½ê²Œ í”ë“¤ë¦¬ì§€ ì•Šê³  ì±…ì„ì„ ì§€ëŠ” íƒ€ì…. ì•ˆì •ê°ì´ ê°•í•˜ê³ , â€˜í•´ì•¼ í•  ì¼â€™ì„ ëê¹Œì§€ ì™„ìˆ˜í•´ìš”.",
      chips:["ì±…ì„ê°","ì•ˆì •","ì›ì¹™","ì§€êµ¬ë ¥"]
    },
    H: { name:"ì¥êµ¬í˜•", code:"H", short:"ë¦¬ë“¬ ì¡°ìœ¨ì",
      desc:"ì „ì²´ íë¦„ê³¼ íŒ€ ë°¸ëŸ°ìŠ¤ë¥¼ ì¡ëŠ” íƒ€ì…. ë¶„ìœ„ê¸°Â·ë¦¬ë“¬Â·ì†ë„ë¥¼ ì¡°ì ˆí•´ ì‚¬ëŒë“¤ì´ ì˜ êµ´ëŸ¬ê°€ê²Œ ë§Œë“¤ì–´ìš”.",
      chips:["ì¡°ìœ¨","ê· í˜•ê°","ëˆˆì¹˜/ì„¼ìŠ¤","ë‹¤ì¬ë‹¤ëŠ¥"]
    },
  };

  // ====== Questions ======
  const questions = [
    {
      title:"ëª¨ì„ì—ì„œ ë‚˜ëŠ”â€¦",
      opts:{
        A:"ë¶„ìœ„ê¸°ë¥¼ ë¶€ë“œëŸ½ê²Œ ë§Œë“ ë‹¤",
        B:"ë§ì€ ì ì§€ë§Œ ì¤‘ì‹¬ì„ ì¡ëŠ”ë‹¤",
        C:"ê°ì •ì´ ì˜¬ë¼ì˜¤ë©´ ë°”ë¡œ í‘œí˜„í•œë‹¤",
        D:"ì¡°ìš©íˆ ë¶„ìœ„ê¸°ë¥¼ ì½ëŠ”ë‹¤",
        E:"ë‚´ê°€ ìˆì–´ì•¼ íŒì´ ì‚°ë‹¤",
        F:"ëˆ„êµ°ê°€ í˜ë“¤ì–´ ë³´ì´ë©´ ë¨¼ì € ì±™ê¸´ë‹¤",
        G:"ì‰½ê²Œ í”ë“¤ë¦¬ì§€ ì•ŠëŠ”ë‹¤",
        H:"íë¦„ì´ ëŠê¸°ë©´ ë‚´ê°€ ì •ë¦¬í•œë‹¤",
      }
    },
    {
      title:"ê°ˆë“± ìƒí™©ì—ì„œ ë‚˜ëŠ”â€¦",
      opts:{
        A:"ì„œë¡œ ê°ì • ìƒí•˜ì§€ ì•Šê²Œ ì¤‘ì¬í•œë‹¤",
        B:"ê°ì •ë³´ë‹¤ ë…¼ë¦¬ë¡œ íŒë‹¨í•œë‹¤",
        C:"ì†”ì§í•˜ê²Œ ë‹¤ ë§í•œë‹¤",
        D:"í•œ ë°œ ë¬¼ëŸ¬ë‚˜ ìƒí™©ì„ ë³¸ë‹¤",
        E:"ê°•í•˜ê²Œ ë°€ì–´ë¶™ì¸ë‹¤",
        F:"ìƒëŒ€ ê°ì •ì„ ë¨¼ì € ê³µê°í•œë‹¤",
        G:"ì›ì¹™ëŒ€ë¡œ ì²˜ë¦¬í•œë‹¤",
        H:"ì „ì²´ ê· í˜•ì„ ë§ì¶˜ë‹¤",
      }
    },
    {
      title:"ë‚´ê°€ ë“£ê³  ì‹¶ì€ ë§ì€?",
      opts:{
        A:"â€œë„ˆ ë•ë¶„ì— ë¶„ìœ„ê¸° ì¢‹ì•„ì¡Œì–´â€",
        B:"â€œì—­ì‹œ ë„ˆëŠ” ë¯¿ìŒì§í•´â€",
        C:"â€œë„ˆ ì§„ì§œ ê°œì„± ìˆë‹¤â€",
        D:"â€œë„Œ ì„¬ì„¸í•˜ë‹¤â€",
        E:"â€œë„ˆ ì—†ìœ¼ë©´ ì•ˆ ëœë‹¤â€",
        F:"â€œë„Œ ì •ë§ ì´í•´ì‹¬ ê¹Šì–´â€",
        G:"â€œì—­ì‹œ ì±…ì„ê° ìˆë‹¤â€",
        H:"â€œë„Œ ì¡°ìœ¨ì„ ì˜í•´â€",
      }
    },
    {
      title:"ì—°ì•  ìŠ¤íƒ€ì¼ì€?",
      opts:{
        A:"ë”°ëœ»í•˜ê²Œ ì˜¤ë˜ ê°€ëŠ” ìŠ¤íƒ€ì¼",
        B:"ì‹ ì¤‘í•˜ê²Œ ì‹œì‘í•œë‹¤",
        C:"ê°ì • í‘œí˜„ì´ í’ë¶€í•˜ë‹¤",
        D:"ì†ë§ˆìŒì€ ê¹Šì§€ë§Œ í‘œí˜„ì€ ì ë‹¤",
        E:"ì§ì§„í˜•",
        F:"ìƒëŒ€ì˜ ê°ì •ì— ì˜ˆë¯¼í•˜ë‹¤",
        G:"ì•ˆì •ì´ ìµœìš°ì„ ",
        H:"ì„œë¡œ ê· í˜•ì´ ë§ëŠ” ê²Œ ì¤‘ìš”",
      }
    },
    {
      title:"ë‚´ê°€ ìŠ¤íŠ¸ë ˆìŠ¤ ë°›ì„ ë•ŒëŠ”?",
      opts:{
        A:"ë¶„ìœ„ê¸°ê°€ ì°¨ê°€ìš¸ ë•Œ",
        B:"ë¬´ê³„íšì¼ ë•Œ",
        C:"ë‹µë‹µí•˜ê²Œ ì°¸ì•„ì•¼ í•  ë•Œ",
        D:"ë„ˆë¬´ ì‹œë„ëŸ¬ìš¸ ë•Œ",
        E:"ë‹µì´ ëŠë¦´ ë•Œ",
        F:"ê³µê° ëª» ë°›ì„ ë•Œ",
        G:"ì±…ì„ì„ ë‹¤ ëª»í–ˆì„ ë•Œ",
        H:"íŒ€ì›Œí¬ê°€ ê¹¨ì§ˆ ë•Œ",
      }
    },
    {
      title:"ë‚˜ëŠ” ì¦‰í¥ì ì¸ê°€?",
      opts:{
        A:"ìƒí™©ì— ë”°ë¼ ë‹¤ë¥´ë‹¤",
        B:"ê±°ì˜ ì•„ë‹ˆë‹¤",
        C:"ê½¤ ì¦‰í¥ì ì´ë‹¤",
        D:"í˜¼ì ìˆì„ ë• ì¦‰í¥ì ì´ë‹¤",
        E:"ì¦‰í¥ ì¶”ì§„ ì¢‹ì•„í•¨",
        F:"ê°ì •ì— ë”°ë¼ ë‹¤ë¦„",
        G:"ê³„íšì´ ìš°ì„ ",
        H:"ì „ì²´ íë¦„ ë³´ê³  ì›€ì§ì¸ë‹¤",
      }
    },
    {
      title:"ë‚˜ì˜ ê°•ì ì€?",
      opts:{
        A:"ë”°ëœ»í•¨",
        B:"ê¹Šì´",
        C:"í‘œí˜„ë ¥",
        D:"ì„¬ì„¸í•¨",
        E:"ì¹´ë¦¬ìŠ¤ë§ˆ",
        F:"ê³µê°ë ¥",
        G:"ì±…ì„ê°",
        H:"ì¡°ìœ¨ ëŠ¥ë ¥",
      }
    },
    {
      title:"ì‚¬ëŒë“¤ì´ ë‚˜ë¥¼ ë³´ëŠ” ì´ë¯¸ì§€ëŠ”?",
      opts:{
        A:"ë¶€ë“œëŸ¬ìš´ ì‚¬ëŒ",
        B:"ë¬µì§í•œ ì‚¬ëŒ",
        C:"ììœ ë¡œìš´ ì‚¬ëŒ",
        D:"ì¡°ìš©í•œ ì‚¬ëŒ",
        E:"ê°•ë ¬í•œ ì‚¬ëŒ",
        F:"ê°ì„±ì ì¸ ì‚¬ëŒ",
        G:"ë“ ë“ í•œ ì‚¬ëŒ",
        H:"ë¶„ìœ„ê¸° ë©”ì´ì»¤",
      }
    },
    {
      title:"ë‚˜ëŠ” ì–´ë–¤ ì†Œë¦¬ì— ê°€ê¹ë‚˜?",
      opts:{
        A:"ë§‘ê³  ë”°ëœ»í•œ ìš¸ë¦¼",
        B:"ë‚®ê³  ê¹Šì€ ìš¸ë¦¼",
        C:"ì‹œì›í•˜ê²Œ ë»—ëŠ” ì†Œë¦¬",
        D:"ë§‘ê³  ê°€ëŠ” ì†Œë¦¬",
        E:"ê°•ë ¬í•˜ê²Œ í„°ì§€ëŠ” ì†Œë¦¬",
        F:"ì‚¬ëŒ ëª©ì†Œë¦¬ ê°™ì€ ì†Œë¦¬",
        G:"ë¬µì§í•˜ê²Œ ìš¸ë¦¬ëŠ” ì†Œë¦¬",
        H:"ë¦¬ë“¬ì„ ì¡ëŠ” ì†Œë¦¬",
      }
    },
  ];

  // ëœë¤ ë°°ì¹˜(ë¬¸í•­ë§ˆë‹¤ ì˜µì…˜ ìˆœì„œ ì„ê¸°) - í˜ì´ì§€ ë¡œë“œ ì‹œ ê³ ì •
  const shuffledOptionsPerQuestion = questions.map(q => {
    const entries = Object.entries(q.opts).map(([key, text]) => ({ key, text }));
    return shuffle(entries);
  });

  // ====== Render ======
  const testEl = document.getElementById("test");
  const resultEl = document.getElementById("result");
  const errEl = document.getElementById("err");
  const barEl = document.getElementById("bar");
  const pctEl = document.getElementById("pct");
  const doneCountEl = document.getElementById("doneCount");

  function render(){
    const frag = document.createDocumentFragment();

    questions.forEach((q, i) => {
      const box = document.createElement("div");
      box.className = "q";
      box.id = `q${i+1}`;

      const h = document.createElement("h3");
      const n = document.createElement("span");
      n.className = "num";
      n.textContent = (i+1);
      h.appendChild(n);

      const t = document.createElement("span");
      t.textContent = q.title;
      h.appendChild(t);

      const multi = document.createElement("span");
      multi.className = "multi";
      multi.textContent = "ë³µìˆ˜ì„ íƒ";
      h.appendChild(multi);

      box.appendChild(h);

      const opts = document.createElement("div");
      opts.className = "opts";

      shuffledOptionsPerQuestion[i].forEach(({key, text}) => {
        const label = document.createElement("label");
        label.className = "opt";

        const input = document.createElement("input");
        input.type = "checkbox";           // âœ… ë³µìˆ˜ì„ íƒ
        input.name = `q${i+1}`;
        input.value = key;
        input.addEventListener("change", updateProgress);

        const tag = document.createElement("span");
        tag.className = "tag";
        tag.textContent = key;             // âœ… A~H ê·¸ëŒ€ë¡œ ë³´ì—¬ì£¼ë˜, ìœ„ì¹˜ëŠ” ì„ì—¬ì„œ ëœë¤

        const span = document.createElement("span");
        span.className = "txt";
        span.textContent = text;

        label.appendChild(input);
        label.appendChild(tag);
        label.appendChild(span);
        opts.appendChild(label);
      });

      box.appendChild(opts);
      frag.appendChild(box);
    });

    const actions = document.querySelector(".actions");
    testEl.insertBefore(frag, actions);
    updateProgress();
  }

  function countAnsweredQuestions(){
    let answered = 0;
    for(let i=1;i<=questions.length;i++){
      const anyChecked = document.querySelectorAll(`input[name="q${i}"]:checked`).length > 0;
      if(anyChecked) answered++;
    }
    return answered;
  }

  function updateProgress(){
    const answered = countAnsweredQuestions();
    const pct = Math.round((answered / questions.length) * 100);
    doneCountEl.textContent = answered;
    barEl.style.width = pct + "%";
    pctEl.textContent = pct + "%";
  }

  function getAnswersByQuestion(){
    const byQ = [];
    for(let i=1;i<=questions.length;i++){
      const checked = Array.from(document.querySelectorAll(`input[name="q${i}"]:checked`)).map(x => x.value);
      byQ.push(checked);
    }
    return byQ;
  }

  // ====== Scoring ======
  function calcResult(){
    errEl.style.display = "none";
    resultEl.style.display = "none";

    const answersByQ = getAnswersByQuestion();
    const missing = [];
    answersByQ.forEach((arr, idx) => { if(arr.length === 0) missing.push(idx+1); });

    if(missing.length){
      errEl.textContent = `ì•„ì§ ì„ íƒí•˜ì§€ ì•Šì€ ë¬¸í•­ì´ ìˆì–´ìš”: ${missing.join(", ")}ë²ˆ (ê° ë¬¸í•­ ìµœì†Œ 1ê°œ ì„ íƒ)`;
      errEl.style.display = "block";
      document.getElementById(`q${missing[0]}`).scrollIntoView({behavior:"smooth", block:"center"});
      return;
    }

    const counts = {A:0,B:0,C:0,D:0,E:0,F:0,G:0,H:0};
    answersByQ.flat().forEach(k => counts[k]++);

    // max + tie
    let max = -1;
    let tied = [];
    for(const k of Object.keys(counts)){
      if(counts[k] > max){
        max = counts[k];
        tied = [k];
      } else if(counts[k] === max){
        tied.push(k);
      }
    }

    // tie-break: Q9 ì„ íƒ ì¤‘ tiedê°€ ìˆìœ¼ë©´ ê·¸ì¤‘ í•˜ë‚˜, ì—†ìœ¼ë©´ Q7, ì—†ìœ¼ë©´ ê³ ì • ìš°ì„ ìˆœìœ„
    const pref = ["E","H","B","G","A","F","C","D"];
    function pickFromQuestion(qIndex){ // 0-based
      for(const k of answersByQ[qIndex]){
        if(tied.includes(k)) return k;
      }
      return null;
    }

    let winner = tied[0];
    if(tied.length > 1){
      winner = pickFromQuestion(8) || pickFromQuestion(6) || pref.find(x => tied.includes(x)) || tied[0];
    }

    showResult(winner, counts);
  }

  function showResult(key, counts){
    const info = mapType[key];

    document.getElementById("rtype").textContent = `ë‹¹ì‹ ì€ ${info.name} ğŸµ`;
    document.getElementById("rdesc").textContent = info.desc;
    document.getElementById("rbadge").textContent = `ìœ í˜• ì½”ë“œ: ${info.code} Â· ${info.short}`;

    const chips = document.getElementById("rchips");
    chips.innerHTML = "";
    info.chips.forEach(c => {
      const el = document.createElement("span");
      el.className = "chip";
      el.textContent = c;
      chips.appendChild(el);
    });

    const share = makeShareText(info, counts);
    const link = makeShareLink(info.code);

    document.getElementById("shareText").textContent = share;
    window.__shareText = share;
    window.__shareLink = link;

    const url = new URL(window.location.href);
    url.searchParams.set("r", info.code);
    window.history.replaceState({}, "", url.toString());

    resultEl.style.display = "block";
    resultEl.scrollIntoView({behavior:"smooth", block:"start"});
  }

  function makeShareText(info, counts){
    const sorted = Object.entries(counts).sort((a,b)=>b[1]-a[1]);
    const top3 = sorted.slice(0,3).map(([k,v]) => `${k}${v}`).join(" Â· ");
    return `ğŸ¶ êµ­ì•…ê¸° ì„±ê²© í…ŒìŠ¤íŠ¸ ê²°ê³¼: ${info.name} (${info.short}) | ì ìˆ˜: ${top3}`;
  }

  function makeShareLink(code){
    const url = new URL(window.location.href);
    url.searchParams.set("r", code);
    return url.toString();
  }

  function resetAll(){
    document.querySelectorAll('input[type="checkbox"]').forEach(i => i.checked = false);
    errEl.style.display = "none";
    resultEl.style.display = "none";
    updateProgress();

    const url = new URL(window.location.href);
    url.searchParams.delete("r");
    window.history.replaceState({}, "", url.toString());

    window.scrollTo({top:0, behavior:"smooth"});
  }

  async function copy(text){
    try{
      await navigator.clipboard.writeText(text);
      return true;
    }catch(e){
      const ta = document.createElement("textarea");
      ta.value = text;
      document.body.appendChild(ta);
      ta.select();
      const ok = document.execCommand("copy");
      document.body.removeChild(ta);
      return ok;
    }
  }

  // ====== Events ======
  document.getElementById("calcBtn").addEventListener("click", calcResult);
  document.getElementById("resetBtn").addEventListener("click", resetAll);

  document.getElementById("copyBtn").addEventListener("click", async () => {
    const ok = await copy(window.__shareText || document.getElementById("shareText").textContent);
    alert(ok ? "ê³µìœ  ë¬¸êµ¬ë¥¼ ë³µì‚¬í–ˆì–´ìš”!" : "ë³µì‚¬ì— ì‹¤íŒ¨í–ˆì–´ìš”. ì§ì ‘ ë“œë˜ê·¸í•´ì„œ ë³µì‚¬í•´ì¤˜!");
  });

  document.getElementById("copyLinkBtn").addEventListener("click", async () => {
    const ok = await copy(window.__shareLink || window.location.href);
    alert(ok ? "ë§í¬ë¥¼ ë³µì‚¬í–ˆì–´ìš”!" : "ë³µì‚¬ì— ì‹¤íŒ¨í–ˆì–´ìš”. ì£¼ì†Œì°½ì—ì„œ ë³µì‚¬í•´ì¤˜!");
  });

  // URLì— ?r=A ìˆìœ¼ë©´ ê²°ê³¼ ë¯¸ë¦¬ë³´ê¸°
  function loadPreviewFromURL(){
    const url = new URL(window.location.href);
    const r = (url.searchParams.get("r") || "").toUpperCase();
    if(mapType[r]){
      const fakeCounts = {A:0,B:0,C:0,D:0,E:0,F:0,G:0,H:0};
      fakeCounts[r]=1;
      showResult(r, fakeCounts);
    }
  }

  render();
  loadPreviewFromURL();
</script>
</body>
</html>
